<html>
  <head>
    <script type="text/javascript">
      var LOCAL_STORAGE_NAME = "app";

      function parseQueryString(queryString) {
        return queryString.split("&").reduce((acc, keyValue) => {
          const [key, value] = keyValue.split("=");
          acc[key] = value;
          return acc;
        }, {});
      }

      let auth = parseQueryString(window.location.hash.replace(/^#/, ""));
      if (auth.access_token !== undefined && auth.expires_in !== undefined) {
        auth.expires_in =
          new Date().valueOf() + parseInt(auth.expires_in, 10) * 1000;
        var currentItem = JSON.parse(
          localStorage.getItem(LOCAL_STORAGE_NAME) || "{}"
        );
        localStorage.setItem(
          LOCAL_STORAGE_NAME,
          JSON.stringify(Object.assign({}, { auth }, currentItem))
        );
        var redirectUrl = window.location.href.split("oauthCallback")[0];
        if (auth.state) {
          try {
            redirectUrl =
              redirectUrl +
              "#" +
              decodeURIComponent(decodeURIComponent(auth.state));
          } catch (e) {}
        }
        debugger;
        location.assign(redirectUrl);
      }
    </script>
  </head>

  <body></body>
</html>
